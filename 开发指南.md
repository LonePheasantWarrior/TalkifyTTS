## 项目描述

1. 由云端大模型驱动的安卓语音合成应用。
2. 通过接入云提供商的基于 AI 的 TTS 在线服务来实现语音合成功能。
3. 计划允许接入多个云服务商的的在线 TTS 服务，实现软件内切换合成引擎。
4. 安卓原生 UI 风格（Material 3 Expressive）。
5. 基于接口的解耦设计，以便后续接入更多语音引擎（TTS 在线服务）。

## 技术栈

本项目采用现代 Android 开发技术栈：

- **语言**：Kotlin
- **UI 框架**：Jetpack Compose + Material 3 Expressive
- **最低 SDK**：30（Android 11）
- **目标 SDK**：36
- **构建工具**：Gradle 8.13 + AGP 8.13.2

## 项目架构

项目采用分层架构设计，实现了清晰的职责分离：

```
app/src/main/java/com/github/lonepheasantwarrior/talkify/
├── MainActivity.kt                    # 应用入口
├── domain/                            # 领域层（业务逻辑核心）
│   └── model/
│       ├── TtsModels.kt               # TTS 引擎和声音领域模型
│       └── SynthesisParams.kt         # 语音合成参数模型
├── infrastructure/                    # 基础设施层（外部服务集成）
│   └── repository/
│       └── AlibabaCloudVoiceRepository.kt  # 阿里云声音仓储实现
└── ui/                                # 表现层（UI 组件）
    ├── components/
    │   ├── EngineSelector.kt          # 引擎切换控件
    │   └── VoicePreview.kt            # 语音预览控件
    ├── screens/
    │   └── MainScreen.kt              # 主界面
    └── theme/                         # 主题配置
        ├── Color.kt                   # 颜色定义
        ├── Theme.kt                   # 主题配置
        └── Type.kt                    # 字体排版
```

### 分层架构说明

**领域层（domain）** 包含核心业务模型和接口定义：
- `TtsEngine`：TTS 引擎数据类，包含引擎 ID、名称和提供商信息
- `Voice`：声音数据类，包含声音 ID、名称、性别和语言
- `SynthesisParams`：语音合成参数数据类
- `VoiceRepository`：声音仓储接口，定义获取声音列表的标准方法

**基础设施层（infrastructure）** 负责外部服务集成和数据获取：
- `AlibabaCloudVoiceRepository`：阿里云百炼引擎的声音仓储实现
- 从资源文件 `bailian-Qwen3-TTS-voices.xml` 读取可用声音列表

**表现层（ui）** 负责用户界面呈现和交互：
- `EngineSelector`：引擎切换组件，显示当前引擎并支持选择
- `VoicePreview`：语音预览组件，包含文本输入、声音选择和播放控制
- `MainScreen`：主界面，整合所有组件实现完整功能

## 已实现功能

### 1. 引擎切换功能

- 显示当前选中的 TTS 引擎信息（名称和提供商）
- 点击弹出 Material 3 底部选择 Sheet
- 支持 SegmentedButton 风格的引擎选择
- 当前默认引擎：阿里云百炼"通义千问3语音合成"

### 2. 语音预览功能

**文本输入区域**：
- 多行文本输入框（3-5 行）
- 支持自定义标签和占位符

**声音选择区域**：
- 水平滚动列表展示可选声音
- 每个声音显示友好的中文名称（如"芊悦"、"苏瑶"等）
- 选中状态有视觉反馈（高亮背景）
- 支持 48 种阿里云通义千问3引擎的声音

**播放控制区域**：
- 长条形 Pill Button 样式
- 播放状态：绿色主题，显示"播放"文字和播放图标
- 停止状态：红色主题，显示"停止"文字和停止图标
- 图标和文字并排显示，不再残缺

### 3. 动态声音加载

- 使用 `LaunchedEffect` 监听引擎变化
- 根据当前引擎动态加载对应的声音列表
- 自动选中第一个可用声音
- 接口设计便于后续扩展其他引擎服务

## 资源文件

- `bailian-Qwen3-TTS-voices.xml`：阿里云百炼通义千问3引擎的声音配置
  - voice_ids：声音英文标识
  - display_names：中文显示名称
  - descriptions：声音特色描述
  - supported_languages：支持语言
  - supported_models：支持的模型版本

## 后续扩展计划

1. 接入阿里云 TTS API 实现实际语音合成功能
2. 添加更多云服务商支持（如讯飞、百度等）
3. 实现语音合成历史记录
4. 添加音频保存和分享功能
5. 支持离线语音合成引擎
